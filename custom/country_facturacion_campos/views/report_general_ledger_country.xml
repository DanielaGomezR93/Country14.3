<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="country_facturacion_campos.report_generalledger_country">
        <t t-call="web.html_container">
            <t t-set="data_report_margin_top" t-value="12"/>
            <t t-set="data_report_header_spacing" t-value="30"/>
            <t t-set="data_report_dpi" t-value="110"/>

            <t t-call="web.internal_layout">
                <div class="page">
	                <style>
                        td{text-align: right;}
                        td h1{text-align: center;padding:0px; margin: 0px;}
                        td h2{text-align: center;center;padding:0px; margin: 0px}
                        th{text-align: center;}
                        thead { display: table-header-group }
                        tfoot { display: table-row-group }
                        tr { page-break-inside: avoid }
                        .clth{
                                border-top: 6px double black;
                                border-bottom: 6px double black;
                        }
                        .cltt{
                                border-top: 2px solid black;
                                font-weight: 600;
                        }
		                .cltd{
                                text-align: center;
		                        word-break: break-all;
                        }
		                .cltd span{
                                text-align: center;
		                        word-break: break-all;
                        }
                    </style>
	                <div class="col-xs-12" style="padding:0px !important;">
		                <table class="table-condensed" style="width:100%;font-size:10px;table-layout: fixed">
	                        <tr><td><h1 class="text-center"><span t-esc="res_company.name"/></h1></td></tr>
			                <tr><td><h2>R.I.F.: <span style="text-transform: uppercase;" class="text-center text-uppercase" t-esc="res_company.partner_id.prefix_vat"/>-<span t-esc="res_company.partner_id.vat"/></h2></td></tr>
	                        <tr><td><h2>MAYOR ANALÍTICO DEL <span t-esc="datetime.datetime.strptime(data['date_from'], '%Y-%m-%d').strftime('%d/%m/%Y')"/> AL <span t-esc="datetime.datetime.strptime(data['date_to'], '%Y-%m-%d').strftime('%d/%m/%Y')"/></h2></td></tr>
		                    <tr><td><h2>Expresado en: Bs</h2></td></tr>
		                    <tr><td><h2>Emitido el <span t-esc="context_timestamp(datetime.datetime.now()).strftime('%d/%m/%Y')"/></h2></td></tr>
		                </table>
                    </div>
                    <table class="table-condensed" style="width:100%;font-size:10px;table-layout: fixed">
                        <thead>
                            <tr class="text-center">
                                <th colspan="1" class="clth">Fecha</th>
	                            <th colspan="1" class="clth">Comprobante</th>
	                            <th colspan="2" class="clth">Empresa</th>
                                <th colspan="1" class="clth">Concepto</th>
	                            <th colspan="1" class="clth">Referencia</th>
	                            <th colspan="1" class="clth">Saldo Anterior</th>
                                <th colspan="1" class="clth">Débito</th>
                                <th colspan="1" class="clth">Crédito</th>
                                <th colspan="1" class="clth">Saldo</th>
                                <th colspan="1" class="clth" groups="base.group_multi_currency">Moneda</th>
                            </tr>
                        </thead>
                        <tbody>
	                        <t t-set="total_debit" t-value="0.00"/>
	                        <t t-set="total_credit" t-value="0.00"/>
	                        <t t-set="total_balance" t-value="0.00"/>
                            <t t-foreach="Accounts" t-as="account">
	                            <t t-set="total_debit" t-value="total_debit + account['debit']"/>
	                            <t t-set="total_credit" t-value="total_credit + account['credit']"/>
	                            <t t-set="total_balance" t-value="total_balance + account['balance']"/>
                                <tr style="font-weight: bold;">
                                    <td colspan="7" class="text-left" style="text-align: left"><!--6-->
                                        <span t-esc="account['code']"/>
                                        <span t-esc="account['name']"/>
                                    </td>
                                    <td colspan="1" class="text-right">
                                        <span t-esc="account['debit']" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                    </td>
                                    <td colspan="1" class="text-right">
                                        <span t-esc="account['credit']" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                    </td>
                                    <td colspan="1" class="text-right">
                                        <span t-esc="account['balance']" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                    </td>
                                    <td colspan="1" groups="base.group_multi_currency"/>
                                </tr>
                                <tr t-foreach="account['move_lines']" t-as="line">
                                    <t t-if="line['ldate']">
                                        <td colspan="1" class="cltd"><span t-esc="line['ldate'].strftime('%d/%m/%Y')"/></td><!--LM -->
                                    </t>
                                    <t t-if="not line['ldate']">
                                        <td colspan="1" class="cltd"><span t-esc="line['ldate']"/></td><!--LM -->
                                    </t>
	                                <td colspan="1" class="cltd"><span t-esc="line['move_name']"/></td>
                                    <td  class="cltd" colspan="2"><span t-esc="line['partner_name']"/></td>
                                    <td class="cltd" colspan="1"><span t-esc="line['lname']"/></td>
	                                <td colspan="1" class="cltd"><span t-if="line['lref']" t-esc="line['lref']"/></td>
	                                <t t-set="saldo_anterior" t-value="line['balance'] + line['credit'] - line['debit']"/>
	                                <td colspan="1" class="text-right">
                                        <span t-esc="saldo_anterior" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                    </td>
                                    <td colspan="1" class="text-right">
                                        <span t-esc="line['debit']" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                    </td>
                                    <td colspan="1" class="text-right">
                                        <span t-esc="line['credit']" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                    </td>
                                    <td colspan="1" class="text-right">
                                        <span t-esc="line['balance']" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                    </td>
                                    <td colspan="1" class="text-right" groups="base.group_multi_currency">
                                        <span t-esc="line['amount_currency'] if line['amount_currency'] > 0.00 else ''"/>
                                        <span t-esc="line['currency_code'] if line['amount_currency'] > 0.00 else ''"/>
                                    </td>
                                </tr>
                            </t>
	                        <tr style="font-weight: bold;">
                                <td colspan="7" class="text-right">
	                                <span>TOTAL GENERAL</span>
                                </td>
                                <td colspan="1" class="text-right">
                                    <span t-esc="total_debit" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                </td>
                                <td colspan="1" class="text-right">
                                    <span t-esc="total_credit" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                </td>
                                <td colspan="1" class="text-right">
                                    <span t-esc="total_balance" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                </td>
                                <td colspan="1" groups="base.group_multi_currency"/>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </t>
        </t>
    </template>
</odoo>
